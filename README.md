# 🌿 스마트 장애물 회피 자동 분무 차량 프로젝트

## 프로젝트 개요
본 프로젝트는 **모터, 초음파 센서, ESP32-CAM, 서보 스프레이**를 활용한 **자동 분무 차량** 시스템입니다.  
장애물 감지 기능과 카메라 실시간 영상 스트리밍 기능을 갖추고 있어, 원격 관찰 및 자동 분무가 가능합니다.  

- **자동 장애물 회피**: 초음파 센서로 전방 거리 측정 후, 장애물 발생 시 후진 후 좌/우 회전으로 회피  
- **실시간 영상 확인**: ESP32-CAM 모듈을 WiFi AP로 연결하여 브라우저에서 실시간 영상 확인 가능  
- **분무 제어**: 서보 모터를 이용해 스프레이를 0° ↔ 180° 반복 회전  

## 사용된 주요 부품

| 부품 | 모델/사양 |
|------|-----------|
| 모터 | DC 모터 4개 |
| 모터 드라이버 | L298N |
| 초음파 센서 | HC-SR04 |
| 카메라 모듈 | ESP32-CAM (AI Thinker) |
| 서보 모터 | 일반 180° 서보 |
| 마이크로컨트롤러 | Arduino / ESP32 |
| 전원 | 7.4V Li-ion 배터리 |

## 프로젝트 구성

1. **Arduino 모터 제어 & 장애물 회피**
   - 전진, 후진, 좌/우 회전 동작
   - 초음파 센서 거리 측정 → 장애물 감지 시 정지 + 회피
   - 장애물 회피 방식: 후진 → 좌/우 회전 랜덤 선택

2. **ESP32-CAM 영상 스트리밍**
   - WiFi AP 모드로 연결
   - 브라우저에서 실시간 영상 확인 가능
   - 카메라 설정: JPEG 스트리밍, UXGA 해상도, PSRAM 활용 시 프레임 개선

3. **스프레이 서보 제어**
   - 0° ↔ 180° 반복 회전
   - 자동 분무 기능 수행

## 사용법

1. **모터 + 센서 연결**
   - IN1~IN8, ENA/ENB, 초음파 센서 트리거/에코 핀 연결
   - 전원 연결 후 Arduino 코드 업로드

2. **ESP32-CAM 설치**
   - `camera_pins.h`에 핀 정의 확인
   - WiFi SSID/비밀번호 설정
   - 코드 업로드 후 Serial Monitor에서 AP IP 확인
   - 브라우저에 IP 입력 → 실시간 영상 확인

3. **스프레이 서보 동작**
   - 서보 핀 연결
   - 코드 업로드 → 0° ↔ 180° 반복

## 주요 코드 특징

- `measure_distance()`: 초음파 센서 거리 측정
- `forward()`, `back()`, `left()`, `right()`, `stop()`: 모터 제어 함수
- 장애물 감지 시 랜덤 좌/우 회전 로직 구현
- ESP32-CAM: JPEG 스트리밍, PSRAM 활용 시 프레임 향상
- 서보 모터: `myservo.write()`로 각도 제어

## 프로젝트 활용

- 농업 자동 분무 차량
- 실내외 자율 주행 로봇
- 원격 관찰 및 영상 모니터링 시스템
- 장애물 회피 기반 이동 플랫폼 연구

## 참고 사항

- 모터 속도 값 조정 필요: `speedFR`, `speedFL`, `speedBR`, `speedBL`  
- 초음파 센서 거리 threshold 조정 가능: `cm` 변수  
- ESP32-CAM 프레임 및 화질 설정은 PSRAM 여부에 따라 달라짐

💡 **Tip**  
- 배터리 연결 시 충분한 전류 공급 필요  
- WiFi 연결 안정성을 위해 ESP32와 공유기 간 거리를 고려  
- 서보와 모터 동시 동작 시 전원 간섭 주의
